{% extends 'base.html' %}
{% load i18n %}
{% block title %}{{ block.super }}{% endblock title %}
{% block style %}
table { width: 100%; text-align: center; padding: 20px; }
th { padding-bottom: 10px; }
td { vertical-align: top; }
td p { margin: 0; }
.total_price { font-weight: bold; }
{% endblock style %}
{% block content %}
<h1>Order details</h1>
<h2>{{ object.car.car_model }} ({{ object.car.plate_number }})</h2>
<div>
    <table>
        <tr>
            <th>Submission date</th>
            <th>Planned completion date</th>
            <th>Status</th>
            {% if object.order_lines.count > 0 %}
            <th>Services</th>
            {% endif %}
            <th class="total_price">Total price</th>
        </tr>
        <tr>
            <td>{{ object.date_start }}</td>
            <td>{{ object.date_finish }}</td>
            <td>{{ object.get_status_display }}</td>
            {% if object.order_lines.count > 0 %}
            <td>{% for service in object.order_lines.all %}
            <p>{{ service.service }} (quantity: {{ service.quantity }})</p>
            {% endfor %}
            </td>
            {% endif %}
            <td class="total_price">{{ object.total_order_sum }}</td>
        </tr>
    </table>
</div>
<div>
    <hr>
    <li>
        <h2>Comment</h2>
        <form method="post" action="{{ request.path }}">
            {% csrf_token %}
            {{ form.as_p }}
            <button type="submit">post review</button>
        </form>
        {% if object.reviews %}
        <ul>
            {% for review in object.reviews.all %}
            <li>
                <h4>{{ review.reviewer }} {{ review.created_at }}</h4>
                <p>{{ review.content }}</p>
            </li>
            {% endfor %}
        </ul>
        {% else %}
        <h3>No reviews for this car yet.</h3>
        {% endif %}
    </li>
</div>

{% endblock content %}